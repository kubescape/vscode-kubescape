import { Logger } from "../../../../../utils/log";

enum Severity {
    Critical,
    High
}

export class WorkloadVulnerabilityReport {   
    public id: string;
    public severity: Severity;
    public fixVersions: string[];
    public fixStatus: string;
    public package: string;
    public version: string;

    constructor(vulnerabilityReport: any) {
        this.id = vulnerabilityReport.id;
        this.severity = vulnerabilityReport.severity === "High" ? Severity.High : Severity.Critical;
        this.fixVersions = vulnerabilityReport.fixVersions;
        this.fixStatus = vulnerabilityReport.fixedState;
        this.package = vulnerabilityReport.package;
        this.version = vulnerabilityReport.version;
        Logger.debug("Workload vulnerability report successfully created")
    }
    
}