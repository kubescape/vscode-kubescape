import { Logger } from "../../../../../utils/log";

export enum Severity {
    Critical,
    High
}

export class ImageVulnerabilityReport {
    public id: string;
    public severity: Severity;
    public fixVersions: string[];
    public fixStatus: string;
    public dataSource: string;
    public namespace: string;
    public description: string;
    public urls: string[];
    public cvss: string[];
    public advisories: {
        id: string,
        link: string
    }[];
    
    constructor(vulnerabilityReport: any) {
        const vuln = vulnerabilityReport.vulnerability;
        this.id = vuln.id;
        this.severity = vuln.severity === "Critical" ? Severity.Critical : Severity.High;
        this.fixVersions = vuln.fix.versions;
        this.fixStatus = vulnerabilityReport.vulnerability.fix.status;
        this.dataSource = vuln.dataSource;
        this.namespace = vuln.namespace;
        this.description = vuln.description;
        this.advisories = vuln.advisories;
        this.cvss = vuln.cvss;
        this.urls = vuln.urls;
        // Logger.debug(`Image vulnerability report added for ${this.id}`);
    }
}